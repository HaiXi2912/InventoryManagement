
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as W,p as X,r as V,A as Y,J as Z,O as ee,c as k,e as y,f as l,t as r,j as te,w as o,H as f,I as v,R as C,P as x,i,o as n,h as s,S as le,v as ae,x as T}from"./index-CdiJTMf6.js";const oe={class:"as-detail"},se={class:"title"},ne={class:"meta"},ue={class:"actions"},ie={key:0,class:"exchange"},de={class:"inline"},A=W({__name:"detail",setup(re){const q=X(),b=Number(q.query.id||q.params.id),d=V(!1),a=V(null),u=V([]);async function w(){d.value=!0;try{const p=await x.get("/after-sales/".concat(b));a.value=p.data}finally{d.value=!1}}async function S(p){d.value=!0;try{await x.post("/after-sales/".concat(b,"/inspect"),{passed:p,remark:p?"验货通过":""}),await w()}finally{d.value=!1}}async function E(){var p;d.value=!0;try{let t={};((p=a.value)==null?void 0:p.type)==="exchange"&&(t.exchange_to=u.value),await x.post("/after-sales/".concat(b,"/complete"),t),await w()}finally{d.value=!1}}async function F(){d.value=!0;try{await x.post("/after-sales/".concat(b,"/approve"),{}),await w()}finally{d.value=!1}}return Y(w),(p,t)=>{var h,D,N,U,B,I,j,K,M,R;const _=i("el-descriptions-item"),H=i("el-tag"),J=i("el-descriptions"),m=i("el-table-column"),$=i("el-table"),c=i("el-button"),L=i("el-option"),O=i("el-select"),P=i("el-input"),G=i("el-input-number"),z=i("el-alert"),Q=ee("loading");return Z((n(),k("div",oe,[y("div",se,"售后 #"+r(te(b)),1),y("div",ne,[l(J,{column:4,size:"small",border:""},{default:o(()=>[l(_,{label:"单号"},{default:o(()=>{var e;return[s(r((e=a.value)==null?void 0:e.as_no),1)]}),_:1}),l(_,{label:"类型"},{default:o(()=>{var e;return[s(r((e=a.value)==null?void 0:e.type),1)]}),_:1}),l(_,{label:"状态"},{default:o(()=>[l(H,{size:"small"},{default:o(()=>{var e;return[s(r((e=a.value)==null?void 0:e.status),1)]}),_:1})]),_:1}),l(_,{label:"退款金额"},{default:o(()=>{var e;return[s("￥"+r((e=a.value)==null?void 0:e.refund_amount),1)]}),_:1}),l(_,{label:"客户"},{default:o(()=>{var e;return[s(r(((e=a.value)==null?void 0:e.customer_id)||"-"),1)]}),_:1}),l(_,{label:"订单"},{default:o(()=>{var e;return[s(r((e=a.value)==null?void 0:e.order_id),1)]}),_:1}),l(_,{label:"备注"},{default:o(()=>{var e;return[s(r((e=a.value)==null?void 0:e.remark),1)]}),_:1}),l(_,{label:"创建时间"},{default:o(()=>{var e;return[s(r((e=a.value)==null?void 0:e.created_at),1)]}),_:1})]),_:1})]),t[13]||(t[13]=y("h4",null,"商品明细",-1)),l($,{data:((h=a.value)==null?void 0:h.items)||[],size:"small",border:""},{default:o(()=>[l(m,{prop:"order_item_id",label:"订单行ID",width:"100"}),l(m,{prop:"sku_id",label:"SKU",width:"100"}),l(m,{prop:"quantity",label:"数量",width:"80"}),l(m,{prop:"amount",label:"金额",width:"100"})]),_:1},8,["data"]),y("div",ue,[((D=a.value)==null?void 0:D.status)==="pending"?(n(),k(C,{key:0},[((N=a.value)==null?void 0:N.type)!=="refund"?(n(),v(c,{key:0,size:"small",type:"success",onClick:t[0]||(t[0]=e=>S(!0))},{default:o(()=>[...t[6]||(t[6]=[s("验货通过",-1)])]),_:1})):f("",!0),((U=a.value)==null?void 0:U.type)!=="refund"?(n(),v(c,{key:1,size:"small",type:"danger",onClick:t[1]||(t[1]=e=>S(!1))},{default:o(()=>[...t[7]||(t[7]=[s("验货不通过",-1)])]),_:1})):f("",!0),((B=a.value)==null?void 0:B.type)==="refund"?(n(),v(c,{key:2,size:"small",type:"primary",onClick:F},{default:o(()=>[...t[8]||(t[8]=[s("直接审批",-1)])]),_:1})):f("",!0)],64)):f("",!0),((I=a.value)==null?void 0:I.status)==="approved"?(n(),k(C,{key:1},[((j=a.value)==null?void 0:j.type)==="exchange"?(n(),k("div",ie,[t[11]||(t[11]=y("div",{class:"sub"},"换货目标（仅同商品不同尺码）",-1)),l($,{data:u.value,size:"small",border:""},{default:o(()=>[l(m,{label:"from_item_id",prop:"from_item_id",width:"120"}),l(m,{label:"to_sku_id",prop:"to_sku_id",width:"120"}),l(m,{label:"quantity",prop:"quantity",width:"90"}),l(m,{label:"操作",width:"100"},{default:o(e=>[l(c,{link:"",size:"small",type:"danger",onClick:g=>u.value.splice(e.$index,1)},{default:o(()=>[...t[9]||(t[9]=[s("移除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),y("div",de,[l(O,{modelValue:u.value._from,"onUpdate:modelValue":t[2]||(t[2]=e=>u.value._from=e),placeholder:"选择来源行",size:"small",style:{width:"160px"}},{default:o(()=>{var e;return[(n(!0),k(C,null,le(((e=a.value)==null?void 0:e.items)||[],g=>(n(),v(L,{key:g.id,label:"行#".concat(g.id),value:g.id},null,8,["label","value"]))),128))]}),_:1},8,["modelValue"]),l(P,{modelValue:u.value._toSku,"onUpdate:modelValue":t[3]||(t[3]=e=>u.value._toSku=e),modelModifiers:{number:!0},placeholder:"目标SKU ID",size:"small",style:{width:"160px"}},null,8,["modelValue"]),l(G,{modelValue:u.value._qty,"onUpdate:modelValue":t[4]||(t[4]=e=>u.value._qty=e),min:1,placeholder:"数量",size:"small"},null,8,["modelValue"]),l(c,{size:"small",onClick:t[5]||(t[5]=()=>{const e=u.value;e._from&&e._toSku&&e._qty&&(u.value.push({from_item_id:e._from,to_sku_id:e._toSku,quantity:e._qty}),e._from=null,e._toSku=null,e._qty=1)})},{default:o(()=>[...t[10]||(t[10]=[s("添加",-1)])]),_:1})])])):f("",!0),l(c,{size:"small",type:"primary",onClick:E},{default:o(()=>[...t[12]||(t[12]=[s("完成售后",-1)])]),_:1})],64)):f("",!0),((K=a.value)==null?void 0:K.status)==="completed"?(n(),v(z,{key:2,title:"该售后已完成",type:"success","show-icon":""})):((M=a.value)==null?void 0:M.status)==="cancelled"?(n(),v(z,{key:3,title:"该售后已撤销",type:"warning","show-icon":""})):((R=a.value)==null?void 0:R.status)==="rejected"?(n(),v(z,{key:4,title:"该售后已拒绝",type:"error","show-icon":""})):f("",!0)])])),[[Q,d.value]])}}});typeof T=="function"&&T(A);const _e=ae(A,[["__scopeId","data-v-ea946281"]]);export{_e as default};
