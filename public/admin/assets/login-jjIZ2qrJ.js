
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as Z,u as G,r as k,a as $,c as C,b as H,e as t,f as a,t as c,n as E,w as s,g as P,h as i,i as w,o as q,_ as J,j as v,k as N,l as F,m as K,p as O,E as b,q as Q,s as W,v as X,x as B}from"./index-CdiJTMf6.js";const Y={class:"login-container"},h={class:"login-content"},ee={class:"login-card"},ae={class:"login-header"},se={class:"logo"},le={class:"form-tabs"},re={key:0,class:"form-container"},oe={class:"form-options"},te={class:"quick-login"},ne={class:"quick-btns nowrap"},ie={key:1,class:"form-container"},de={class:"login-footer"},I=Z({__name:"login",setup(ue){const L=Q(),M=O(),V=G(),_=k(),y=k(),d=k(!0),r=$({username:"admin",password:"123456",remember:!1}),o=$({username:"",email:"",password:"",confirmPassword:"",agree:!1}),g=k(!1),T={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度为3-20个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度为6-20个字符",trigger:"blur"}]},j={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度为3-20个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度为6-20个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(n,e,u)=>{e!==o.password?u(new Error("两次输入密码不一致")):u()},trigger:"blur"}],agree:[{validator:(n,e,u)=>{e?u():u(new Error("请同意用户协议"))},trigger:"change"}]},A=()=>{var n,e;d.value=!d.value,d.value?(n=y.value)==null||n.resetFields():(e=_.value)==null||e.resetFields()},z=async()=>{_.value&&await _.value.validate(async n=>{if(n){g.value=!0;try{await V.login({account:r.username,password:r.password});const u=(V.role||localStorage.getItem("role"))==="agent"?"/cs/workbench":M.query.redirect||"/";b.success("登录成功，正在跳转..."),L.replace(u)}catch(e){b.error("登录失败，请检查用户名和密码")}finally{g.value=!1}}})},R=async()=>{y.value&&await y.value.validate(async n=>{if(n){g.value=!0;try{await V.register({username:o.username,email:o.email,password:o.password}),b.success("注册成功！请登录"),d.value=!0,await W(),r.username=o.username}catch(e){b.error((e==null?void 0:e.message)||"注册失败，请稍后重试")}finally{g.value=!1}}})},x=n=>{n==="admin"?(r.username="admin",r.password="123456"):n==="manager"?(r.username="manager",r.password="123456"):n==="agent"&&(r.username="agent1",r.password="123456")},D=()=>{b.info("请联系系统管理员重置密码")};return(n,e)=>{const u=J,f=w("el-input"),m=w("el-form-item"),U=w("el-checkbox"),p=w("el-button"),S=w("el-form");return q(),C("div",Y,[e[24]||(e[24]=H('<div class="login-background" data-v-00a42a9d><div class="bg-shapes" data-v-00a42a9d><div class="shape shape-1" data-v-00a42a9d></div><div class="shape shape-2" data-v-00a42a9d></div><div class="shape shape-3" data-v-00a42a9d></div></div></div>',1)),t("div",h,[t("div",ee,[t("div",ae,[t("div",se,[a(u,{name:"i-ep:shop",size:"40",color:"#409EFF"})]),e[13]||(e[13]=t("h1",null,"进销存管理系统",-1)),t("p",null,c(d.value?"欢迎回来":"创建新账户"),1)]),t("div",le,[t("button",{class:E(["tab-btn",{active:d.value}]),onClick:e[0]||(e[0]=l=>d.value=!0)}," 登录 ",2),t("button",{class:E(["tab-btn",{active:!d.value}]),onClick:e[1]||(e[1]=l=>d.value=!1)}," 注册 ",2)]),d.value?(q(),C("div",re,[a(S,{ref_key:"loginFormRef",ref:_,model:r,rules:T,size:"large",onSubmit:P(z,["prevent"])},{default:s(()=>[a(m,{prop:"username"},{default:s(()=>[a(f,{modelValue:r.username,"onUpdate:modelValue":e[2]||(e[2]=l=>r.username=l),placeholder:"请输入用户名","prefix-icon":v(N),clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),a(m,{prop:"password"},{default:s(()=>[a(f,{modelValue:r.password,"onUpdate:modelValue":e[3]||(e[3]=l=>r.password=l),type:"password",placeholder:"请输入密码","prefix-icon":v(F),"show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),a(m,null,{default:s(()=>[t("div",oe,[a(U,{modelValue:r.remember,"onUpdate:modelValue":e[4]||(e[4]=l=>r.remember=l)},{default:s(()=>[...e[14]||(e[14]=[i("记住我",-1)])]),_:1},8,["modelValue"]),a(p,{type:"primary",link:"",onClick:D},{default:s(()=>[...e[15]||(e[15]=[i(" 忘记密码？ ",-1)])]),_:1})])]),_:1}),a(m,null,{default:s(()=>[a(p,{type:"primary",size:"large",style:{width:"100%"},loading:g.value,onClick:z},{default:s(()=>[a(u,{name:"i-ep:user"}),i(" "+c(g.value?"登录中...":"登录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),t("div",te,[e[19]||(e[19]=t("p",null,"快速登录：",-1)),t("div",ne,[a(p,{size:"small",onClick:e[5]||(e[5]=l=>x("agent"))},{default:s(()=>[...e[16]||(e[16]=[i("客服",-1)])]),_:1}),a(p,{size:"small",onClick:e[6]||(e[6]=l=>x("admin"))},{default:s(()=>[...e[17]||(e[17]=[i("管理员",-1)])]),_:1}),a(p,{size:"small",onClick:e[7]||(e[7]=l=>x("manager"))},{default:s(()=>[...e[18]||(e[18]=[i("店长",-1)])]),_:1})])])])):(q(),C("div",ie,[a(S,{ref_key:"registerFormRef",ref:y,model:o,rules:j,size:"large",onSubmit:P(R,["prevent"])},{default:s(()=>[a(m,{prop:"username"},{default:s(()=>[a(f,{modelValue:o.username,"onUpdate:modelValue":e[8]||(e[8]=l=>o.username=l),placeholder:"请输入用户名","prefix-icon":v(N),clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),a(m,{prop:"email"},{default:s(()=>[a(f,{modelValue:o.email,"onUpdate:modelValue":e[9]||(e[9]=l=>o.email=l),placeholder:"请输入邮箱地址","prefix-icon":v(K),clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),a(m,{prop:"password"},{default:s(()=>[a(f,{modelValue:o.password,"onUpdate:modelValue":e[10]||(e[10]=l=>o.password=l),type:"password",placeholder:"请输入密码","prefix-icon":v(F),"show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),a(m,{prop:"confirmPassword"},{default:s(()=>[a(f,{modelValue:o.confirmPassword,"onUpdate:modelValue":e[11]||(e[11]=l=>o.confirmPassword=l),type:"password",placeholder:"请确认密码","prefix-icon":v(F),"show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),a(m,{prop:"agree"},{default:s(()=>[a(U,{modelValue:o.agree,"onUpdate:modelValue":e[12]||(e[12]=l=>o.agree=l)},{default:s(()=>[e[22]||(e[22]=i(" 我已阅读并同意 ",-1)),a(p,{type:"primary",link:""},{default:s(()=>[...e[20]||(e[20]=[i("《用户协议》",-1)])]),_:1}),e[23]||(e[23]=i(" 和 ",-1)),a(p,{type:"primary",link:""},{default:s(()=>[...e[21]||(e[21]=[i("《隐私政策》",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(m,null,{default:s(()=>[a(p,{type:"primary",size:"large",style:{width:"100%"},loading:g.value,onClick:R},{default:s(()=>[a(u,{name:"i-ep:user-plus"}),i(" "+c(g.value?"注册中...":"注册账户"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])),t("div",de,[t("p",null,[i(c(d.value?"还没有账户？":"已有账户？")+" ",1),a(p,{type:"primary",link:"",onClick:A},{default:s(()=>[i(c(d.value?"立即注册":"立即登录"),1)]),_:1})])])])])])}}});typeof B=="function"&&B(I);const pe=X(I,[["__scopeId","data-v-00a42a9d"]]);export{pe as default};
