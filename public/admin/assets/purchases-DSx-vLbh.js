
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as Be,r as i,F as ae,A as Ee,c as C,f as l,w as u,E as s,i as f,o as c,Q as De,h as n,J as Qe,e as _,O as Ge,I as x,t as g,H as y,R as me,S as ve,U as Oe,x as ce}from"./index-CdiJTMf6.js";import{F as w}from"./factory-Cu575xa5.js";import{P as je,a as B}from"./productExt-B7DASDm9.js";const He={class:"p-4"},Je={class:"mt-3",style:{"text-align":"right"}},We={style:{display:"flex",gap:"8px","align-items":"center","margin-bottom":"6px"}},Ye={key:0,style:{"margin-bottom":"8px","font-weight":"600"}},Ze={style:{display:"flex","flex-wrap":"wrap",gap:"10px"}},el={style:{display:"flex","align-items":"center",gap:"8px","margin-top":"8px"}},ll={key:2,class:"mb-2",style:{display:"flex",gap:"8px","align-items":"center","flex-wrap":"wrap"}},tl={key:3,class:"mb-2"},al={style:{display:"flex","align-items":"center",gap:"12px","margin-bottom":"6px"}},ul={style:{display:"flex","flex-wrap":"wrap",gap:"8px"}},ol={key:0,style:{color:"#909399","font-size":"12px"}},nl={key:5,style:{"text-align":"right"}},il={style:{flex:"1","text-align":"left"}},sl=Be({__name:"purchases",setup(dl){const O=i(!1),ue=i([]),oe=i(0),F=i(1),j=i(10),H=i(""),J=i(""),W=i(""),T=i(!1),A=i(!1),L=i(""),U=i([]),E=i([]),Y=i(""),d=i(null),P=i([]),S=i([]),Z=i("apparel"),ee=i(0),D=i(""),N=i([]),$=i(5),Q=i(20),fe={planned:"计划中",approved:"已批准",in_production:"生产中",completed:"已完成",shipped:"确认入库",cancelled:"已取消"},ge=a=>fe[String(a||"")]||a||"-",ye=a=>({planned:"info",approved:"success",in_production:"warning",completed:"",shipped:"success",cancelled:"info"})[String(a||"")]||"info",be={approve:"批准",start:"开工",complete:"完成",ship:"确认入库",cancel:"取消"},_e=i(!1);i("apparel"),i(36),i(44),i(1),i(""),i([]);const ke=ae(()=>{const a=(Y.value||"").trim().toLowerCase();return a?E.value.filter(e=>(e.name||"").toLowerCase().includes(a)||(e.code||"").toLowerCase().includes(a)||(e.barcode||"").toLowerCase().includes(a)):E.value}),b=async()=>{var a,e,o;O.value=!0;try{const m=await w.list({page:F.value,size:j.value,status:H.value||void 0,keyword:J.value||void 0,source:W.value||void 0}),z=((a=m==null?void 0:m.data)==null?void 0:a.orders)||[];ue.value=z,oe.value=((o=(e=m==null?void 0:m.data)==null?void 0:e.pagination)==null?void 0:o.total)||z.length}catch(m){s.error("加载失败")}finally{O.value=!1}},xe=()=>{A.value=!1,L.value="",U.value=[],d.value=null,P.value=[],S.value=[],T.value=!0},we=async()=>{var a;try{const e=await je.getProductList({page:1,limit:300,status:"active"});E.value=((a=e==null?void 0:e.data)==null?void 0:a.products)||[]}catch(e){E.value=[]}},ne=async()=>{if(d.value)try{const a=await B.listSkuStocks(String(d.value.id));N.value=(a==null?void 0:a.data)||[]}catch(a){N.value=[]}},Ve=async()=>{if(d.value)try{const a=N.value.map(e=>{var o,m;return{id:e.id,reorder_threshold:(o=e.reorder_threshold)!=null?o:null,reorder_target:(m=e.reorder_target)!=null?m:null}});await B.saveReorderConfig(String(d.value.id),a),s.success("阈值/目标已保存")}catch(a){s.error("保存失败")}},ze=()=>{for(const a of N.value)a.reorder_threshold=Number($.value||0),a.reorder_target=Number(Q.value||0)},Ce=async()=>{var a,e;if(!d.value){s.warning("请先选择商品");return}try{const o=Number(((a=d.value)==null?void 0:a.purchase_price)||0),m=await w.autoReplenishByProduct({product_id:String(d.value.id),threshold:Number($.value||5),plan:Number(Q.value||20),unit_cost:o});((e=m==null?void 0:m.data)==null?void 0:e.items)>0?(s.success("已生成自动补货订单"),T.value=!1,b()):s.info("无需补货")}catch(o){s.error("生成失败")}},le=async a=>{var e;d.value=a;try{const o=await B.listSkus(String(a.id)),m=Array.isArray(o==null?void 0:o.data)?o==null?void 0:o.data:((e=o==null?void 0:o.data)==null?void 0:e.skus)||[];P.value=(m||[]).map(k=>({id:k.id,size:k.size,stock:k.stock}));const z=Number(a.purchase_price||0);S.value=P.value.map(k=>({sku_id:k.id,size:k.size,qty:0,unit_cost:z})),await ne()}catch(o){P.value=[],S.value=[],N.value=[]}},Se=()=>{if(!d.value)return;const a=S.value.filter(e=>Number(e.qty)>0);if(!a.length){s.warning("请填写各尺码的数量");return}for(const e of a)U.value.push({product_id:d.value.id,product_name:d.value.name,sku_id:e.sku_id,size:e.size,quantity:Number(e.qty||0),unit_cost:Number(e.unit_cost||0)});S.value=S.value.map(e=>({...e,qty:0}))},he=a=>{U.value.splice(a,1)},Ue=ae(()=>U.value.reduce((a,e)=>a+Number(e.unit_cost||0)*Number(e.quantity||0),0)),Ne=async()=>{if(!U.value.length){s.warning("请先添加明细");return}try{await w.create({expedite:A.value,remark:L.value,items:U.value.map(a=>({product_id:Number(a.product_id),sku_id:a.sku_id?Number(a.sku_id):void 0,size:a.size,quantity:Number(a.quantity||0),unit_cost:Number(a.unit_cost||0),remark:a.remark}))}),s.success("提交成功"),T.value=!1,b()}catch(a){s.error("提交失败")}},R=async(a,e)=>{try{await Oe.confirm("确定执行 ".concat(be[e]," ?"),"提示",{type:"warning"}),e==="approve"&&await w.approve(a.id),e==="start"&&await w.start(a.id),e==="complete"&&await w.complete(a.id),e==="ship"&&await w.ship(a.id),e==="cancel"&&await w.cancel(a.id),s.success("操作成功"),b()}catch(o){}},ie=async a=>{try{if(!["planned","approved"].includes(a.status)){s.warning("当前状态不可修改加急");return}await w.update(a.id,{expedite:!a.expedite}),s.success("已更新加急状态"),b()}catch(e){s.error("更新失败")}},Te=async()=>{try{await w.autoReplenish(),s.success("已触发自动补货"),b()}catch(a){s.error("触发失败")}},qe=async()=>{if(!d.value){s.warning("请先选择商品");return}try{await B.batchCreateSkusBySize(String(d.value.id),{template:Z.value}),s.success("已批量生成SKU"),await le(d.value)}catch(a){s.error("生成失败")}},Fe=async()=>{if(!d.value){s.warning("请先选择商品");return}if(!D.value){s.warning("请输入来源商品ID");return}try{await B.copySkusFrom(String(d.value.id),D.value,{}),s.success("已复制SKU"),await le(d.value)}catch(a){s.error("复制失败")}},Pe=()=>{const a=Number(ee.value||0);if(a<=0){s.warning("请输入数量");return}S.value=S.value.map(e=>({...e,qty:a}))},V=i(!1),G=i(null),I=i({}),Ae=()=>{var e;const a={};for(const o of P.value)a[String(o.size)]=0;I.value=a,G.value=Number(((e=d.value)==null?void 0:e.purchase_price)||0)},Le=async()=>{if(!d.value){s.warning("请先选择商品");return}if(!Object.values(I.value).some(a=>Number(a)>0)){s.warning("请至少填写一个尺码数量");return}try{await w.quickAdd({product_id:d.value.id,size_quantities:I.value,unit_cost:G.value||0,expedite:A.value,remark:L.value}),s.success("提交成功"),T.value=!1,b()}catch(a){s.error("提交失败")}};i("none"),ae(()=>"本页面创建的工厂订单均为手动提交（来源：手动）。自动补货单由库存变动自动生成，可在列表按“来源=自动补货”筛选查看。");const $e=a=>{var o,m;const e=Number((m=(o=a.reorder_threshold)!=null?o:$.value)!=null?m:0);return e>0&&Number(a.stock||0)<e?"danger":"success"};return Ee(()=>{b(),we()}),(a,e)=>{const o=f("el-option"),m=f("el-select"),z=f("el-form-item"),k=f("el-input"),v=f("el-button"),se=f("el-form"),Re=f("el-alert"),te=f("el-card"),r=f("el-table-column"),K=f("el-table"),q=f("el-tag"),Ie=f("el-pagination"),de=f("el-switch"),re=f("el-col"),h=f("el-input-number"),pe=f("el-divider"),Ke=f("el-row"),Me=f("el-dialog"),Xe=Ge("loading");return c(),C("div",He,[l(te,{class:"mb-4",shadow:"never"},{header:u(()=>[...e[21]||(e[21]=[n("筛选",-1)])]),default:u(()=>[l(se,{inline:""},{default:u(()=>[l(z,{label:"状态"},{default:u(()=>[l(m,{modelValue:H.value,"onUpdate:modelValue":e[0]||(e[0]=t=>H.value=t),clearable:"",style:{width:"160px"},onChange:e[1]||(e[1]=()=>{F.value=1,b()})},{default:u(()=>[l(o,{label:"全部",value:""}),l(o,{label:"计划中",value:"planned"}),l(o,{label:"已批准",value:"approved"}),l(o,{label:"生产中",value:"in_production"}),l(o,{label:"已完成",value:"completed"}),l(o,{label:"确认入库",value:"shipped"}),l(o,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),l(z,{label:"来源"},{default:u(()=>[l(m,{modelValue:W.value,"onUpdate:modelValue":e[2]||(e[2]=t=>W.value=t),clearable:"",style:{width:"160px"},onChange:e[3]||(e[3]=()=>{F.value=1,b()})},{default:u(()=>[l(o,{label:"全部",value:""}),l(o,{label:"手动",value:"manual"}),l(o,{label:"自动补货",value:"auto_replenish"}),l(o,{label:"迁移",value:"migration"})]),_:1},8,["modelValue"])]),_:1}),l(z,{label:"关键字"},{default:u(()=>[l(k,{modelValue:J.value,"onUpdate:modelValue":e[4]||(e[4]=t=>J.value=t),placeholder:"工厂单号",style:{width:"200px"},clearable:"",onKeyup:e[5]||(e[5]=De(()=>{F.value=1,b()},["enter"]))},null,8,["modelValue"])]),_:1}),l(v,{type:"primary",onClick:xe},{default:u(()=>[...e[22]||(e[22]=[n("新建订货单",-1)])]),_:1}),l(v,{onClick:Te},{default:u(()=>[...e[23]||(e[23]=[n("自动补货",-1)])]),_:1})]),_:1}),l(Re,{class:"mt-3",type:"info","show-icon":"",closable:!1},{default:u(()=>[...e[24]||(e[24]=[n(" 销售确认后若SKU库存低于商品安全库存或SKU阈值，会自动生成工厂订单。也可点击“自动补货”立即扫描补货。 ",-1)])]),_:1})]),_:1}),l(te,{shadow:"never"},{default:u(()=>[Qe((c(),x(K,{data:ue.value,stripe:""},{default:u(()=>[l(r,{type:"expand"},{default:u(({row:t})=>[l(K,{data:t.details||[],size:"small"},{default:u(()=>[l(r,{label:"商品",prop:"product.name","min-width":"160"},{default:u(({row:p})=>{var M;return[n(g(((M=p.product)==null?void 0:M.name)||"-"),1)]}),_:1}),l(r,{label:"尺码",prop:"size",width:"90"}),l(r,{label:"数量",prop:"quantity",width:"90",align:"center"}),l(r,{label:"单价",width:"110",align:"right"},{default:u(({row:p})=>[n("¥"+g(Number(p.unit_cost||0).toFixed(2)),1)]),_:1}),l(r,{label:"小计",width:"120",align:"right"},{default:u(({row:p})=>[n("¥"+g(Number(p.subtotal_cost||0).toFixed(2)),1)]),_:1}),l(r,{label:"备注",prop:"remark","min-width":"120"})]),_:1},8,["data"])]),_:1}),l(r,{prop:"order_no",label:"工厂单号",width:"160"}),l(r,{prop:"source",label:"来源",width:"120"},{default:u(({row:t})=>[l(q,{size:"small",type:t.source==="auto_replenish"?"success":t.source==="migration"?"warning":"info"},{default:u(()=>[n(g(t.source==="auto_replenish"?"自动":t.source==="migration"?"迁移":"手动"),1)]),_:2},1032,["type"])]),_:1}),l(r,{prop:"status",label:"状态",width:"110"},{default:u(({row:t})=>[l(q,{type:ye(t.status),size:"small"},{default:u(()=>[n(g(ge(t.status)),1)]),_:2},1032,["type"])]),_:1}),l(r,{label:"加急",width:"100"},{default:u(({row:t})=>[t.expedite?(c(),x(q,{key:0,type:"danger",size:"small"},{default:u(()=>[...e[25]||(e[25]=[n("加急",-1)])]),_:1})):(c(),x(v,{key:1,link:"",size:"小",onClick:p=>ie(t),disabled:!["planned","approved"].includes(t.status)},{default:u(()=>[...e[26]||(e[26]=[n("申请加急",-1)])]),_:1},8,["onClick","disabled"]))]),_:1}),l(r,{prop:"total_cost",label:"合计成本",width:"120",align:"right"},{default:u(({row:t})=>[n("¥"+g(Number(t.total_cost||0).toFixed(2)),1)]),_:1}),l(r,{prop:"createdAt",label:"创建时间",width:"180"}),l(r,{label:"操作",width:"420",fixed:"right"},{default:u(({row:t})=>[l(v,{size:"small",onClick:p=>R(t,"approve"),disabled:!["planned"].includes(t.status)},{default:u(()=>[...e[27]||(e[27]=[n("批准",-1)])]),_:1},8,["onClick","disabled"]),l(v,{size:"small",onClick:p=>R(t,"start"),disabled:!["approved"].includes(t.status)},{default:u(()=>[...e[28]||(e[28]=[n("开工",-1)])]),_:1},8,["onClick","disabled"]),l(v,{size:"small",onClick:p=>R(t,"complete"),disabled:!["in_production"].includes(t.status)},{default:u(()=>[...e[29]||(e[29]=[n("完成",-1)])]),_:1},8,["onClick","disabled"]),l(v,{size:"small",onClick:p=>R(t,"ship"),disabled:!["completed"].includes(t.status)},{default:u(()=>[...e[30]||(e[30]=[n("确认入库",-1)])]),_:1},8,["onClick","disabled"]),l(v,{size:"small",type:"danger",onClick:p=>R(t,"cancel"),disabled:["shipped","cancelled"].includes(t.status)},{default:u(()=>[...e[31]||(e[31]=[n("取消",-1)])]),_:1},8,["onClick","disabled"]),l(v,{size:"small",text:"",onClick:p=>ie(t),disabled:!["planned","approved"].includes(t.status)},{default:u(()=>[n(g(t.expedite?"取消加急":"设为加急"),1)]),_:2},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[Xe,O.value]]),_("div",Je,[l(Ie,{"current-page":F.value,"onUpdate:currentPage":e[6]||(e[6]=t=>F.value=t),"page-size":j.value,"onUpdate:pageSize":e[7]||(e[7]=t=>j.value=t),total:oe.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:b,onSizeChange:b},null,8,["current-page","page-size","total"])])]),_:1}),l(Me,{modelValue:T.value,"onUpdate:modelValue":e[20]||(e[20]=t=>T.value=t),title:"新建订货单（工厂生产）",width:"85%"},{footer:u(()=>[_("div",il,"合计：¥"+g(Ue.value.toFixed(2)),1),l(v,{onClick:e[19]||(e[19]=t=>T.value=!1)},{default:u(()=>[...e[49]||(e[49]=[n("取消",-1)])]),_:1}),l(v,{type:"primary",disabled:!U.value.length,onClick:Ne},{default:u(()=>[...e[50]||(e[50]=[n("提交",-1)])]),_:1},8,["disabled"])]),default:u(()=>[l(se,{"label-width":"80px"},{default:u(()=>[l(z,{label:"加急"},{default:u(()=>[l(de,{modelValue:A.value,"onUpdate:modelValue":e[8]||(e[8]=t=>A.value=t)},null,8,["modelValue"])]),_:1}),l(z,{label:"备注"},{default:u(()=>[l(k,{modelValue:L.value,"onUpdate:modelValue":e[9]||(e[9]=t=>L.value=t),placeholder:"可填写交期、颜色等"},null,8,["modelValue"])]),_:1})]),_:1}),l(Ke,{gutter:12},{default:u(()=>[l(re,{span:12},{default:u(()=>[_("div",We,[e[32]||(e[32]=_("b",null,"商品",-1)),l(k,{modelValue:Y.value,"onUpdate:modelValue":e[10]||(e[10]=t=>Y.value=t),placeholder:"按名称/编码/条码过滤",clearable:"",style:{"max-width":"220px"}},null,8,["modelValue"])]),l(K,{data:ke.value,height:"360",onRowClick:le},{default:u(()=>[l(r,{prop:"name",label:"名称"}),l(r,{prop:"category",label:"分类",width:"100"}),l(r,{prop:"purchase_price",label:"成本价",width:"100",align:"right"},{default:u(({row:t})=>[n("¥"+g(Number(t.purchase_price||0).toFixed(2)),1)]),_:1})]),_:1},8,["data"])]),_:1}),l(re,{span:12},{default:u(()=>[d.value?(c(),C("div",Ye,g(d.value.name)+" - 按尺码录入",1)):y("",!0),d.value?(c(),x(te,{key:1,class:"mb-2",shadow:"never"},{header:u(()=>[...e[33]||(e[33]=[n("尺码库存",-1)])]),default:u(()=>[_("div",Ze,[(c(!0),C(me,null,ve(N.value,t=>(c(),C("div",{key:String(t.id),style:{display:"flex","align-items":"center",gap:"6px"}},[l(q,null,{default:u(()=>[n(g(t.size),1)]),_:2},1024),l(q,{type:$e(t)},{default:u(()=>[n("库存 "+g(t.stock),1)]),_:2},1032,["type"]),l(q,{type:"warning"},{default:u(()=>[n("占用 "+g(t.locked),1)]),_:2},1024),l(h,{modelValue:t.reorder_threshold,"onUpdate:modelValue":p=>t.reorder_threshold=p,modelModifiers:{number:!0},min:0,max:9999,step:1,size:"small",placeholder:"阈值"},null,8,["modelValue","onUpdate:modelValue"]),l(h,{modelValue:t.reorder_target,"onUpdate:modelValue":p=>t.reorder_target=p,modelModifiers:{number:!0},min:0,max:99999,step:1,size:"small",placeholder:"目标"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),_("div",el,[e[38]||(e[38]=_("span",null,"默认阈值",-1)),l(h,{modelValue:$.value,"onUpdate:modelValue":e[11]||(e[11]=t=>$.value=t),min:0,max:9999},null,8,["modelValue"]),e[39]||(e[39]=_("span",null,"默认目标",-1)),l(h,{modelValue:Q.value,"onUpdate:modelValue":e[12]||(e[12]=t=>Q.value=t),min:0,max:9999},null,8,["modelValue"]),l(v,{size:"small",onClick:ze},{default:u(()=>[...e[34]||(e[34]=[n("应用到所有尺码",-1)])]),_:1}),l(v,{size:"small",type:"primary",onClick:Ce},{default:u(()=>[...e[35]||(e[35]=[n("单商品自动补货",-1)])]),_:1}),l(v,{size:"small",onClick:Ve},{default:u(()=>[...e[36]||(e[36]=[n("保存阈值/目标",-1)])]),_:1}),l(v,{size:"small",onClick:ne},{default:u(()=>[...e[37]||(e[37]=[n("刷新库存",-1)])]),_:1})])]),_:1})):y("",!0),d.value?(c(),C("div",ll,[l(de,{modelValue:V.value,"onUpdate:modelValue":e[13]||(e[13]=t=>V.value=t),"active-text":"尺码网格快速下单",onChange:Ae},null,8,["modelValue"]),l(v,{size:"small",onClick:e[14]||(e[14]=t=>_e.value=!0)},{default:u(()=>[...e[40]||(e[40]=[n("尺码助手",-1)])]),_:1}),V.value?y("",!0):(c(),x(m,{key:0,modelValue:Z.value,"onUpdate:modelValue":e[15]||(e[15]=t=>Z.value=t),style:{width:"160px"}},{default:u(()=>[l(o,{label:"通用服装(XS-XXL)",value:"apparel"}),l(o,{label:"全尺码(XS-XXXL)",value:"full"}),l(o,{label:"童装(100-160)",value:"kids"}),l(o,{label:"均码",value:"one"})]),_:1},8,["modelValue"])),V.value?y("",!0):(c(),x(v,{key:1,size:"small",onClick:qe},{default:u(()=>[...e[41]||(e[41]=[n("按模板生成SKU",-1)])]),_:1})),V.value?y("",!0):(c(),x(k,{key:2,modelValue:D.value,"onUpdate:modelValue":e[16]||(e[16]=t=>D.value=t),placeholder:"来源商品ID",style:{width:"160px"}},null,8,["modelValue"])),V.value?y("",!0):(c(),x(v,{key:3,size:"small",onClick:Fe},{default:u(()=>[...e[42]||(e[42]=[n("从商品复制SKU",-1)])]),_:1})),e[44]||(e[44]=_("span",{style:{flex:"1"}},null,-1)),V.value?y("",!0):(c(),x(h,{key:4,modelValue:ee.value,"onUpdate:modelValue":e[17]||(e[17]=t=>ee.value=t),min:0,max:9999,step:1},null,8,["modelValue"])),V.value?y("",!0):(c(),x(v,{key:5,size:"small",onClick:Pe},{default:u(()=>[...e[43]||(e[43]=[n("一键填充数量",-1)])]),_:1}))])):y("",!0),V.value&&d.value?(c(),C("div",tl,[_("div",al,[e[46]||(e[46]=_("span",null,"统一成本价",-1)),l(h,{modelValue:G.value,"onUpdate:modelValue":e[18]||(e[18]=t=>G.value=t),min:0,step:.5},null,8,["modelValue"]),l(v,{size:"small",type:"primary",onClick:Le},{default:u(()=>[...e[45]||(e[45]=[n("网格下单并提交",-1)])]),_:1})]),_("div",ul,[(c(!0),C(me,null,ve(P.value,t=>{var p,M;return c(),C("div",{key:String(t.id),style:{display:"flex","align-items":"center",gap:"6px"}},[l(q,{type:"info",style:{"min-width":"48px","text-align":"center"}},{default:u(()=>[n(g(t.size),1)]),_:2},1024),l(h,{modelValue:I.value[String(t.size)],"onUpdate:modelValue":X=>I.value[String(t.size)]=X,modelModifiers:{number:!0},min:0,max:9999,step:1},null,8,["modelValue","onUpdate:modelValue"]),N.value.find(X=>X.size===t.size)?(c(),C("span",ol,"库存 "+g((M=(p=N.value.find(X=>X.size===t.size))==null?void 0:p.stock)!=null?M:0),1)):y("",!0)])}),128))]),l(pe)])):y("",!0),!V.value&&d.value?(c(),x(K,{key:4,data:S.value,size:"small",style:{"margin-bottom":"8px"}},{default:u(()=>[l(r,{prop:"size",label:"尺码",width:"120"}),l(r,{label:"数量",width:"150"},{default:u(({row:t})=>[l(h,{modelValue:t.qty,"onUpdate:modelValue":p=>t.qty=p,modelModifiers:{number:!0},min:0,max:9999,step:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(r,{label:"成本价",width:"160",align:"right"},{default:u(({row:t})=>[l(h,{modelValue:t.unit_cost,"onUpdate:modelValue":p=>t.unit_cost=p,modelModifiers:{number:!0},min:0,step:.5},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(r,{label:"小计",width:"140",align:"right"},{default:u(({row:t})=>[n("¥"+g((Number(t.unit_cost||0)*Number(t.qty||0)).toFixed(2)),1)]),_:1})]),_:1},8,["data"])):y("",!0),d.value?(c(),C("div",nl,[l(v,{onClick:Se},{default:u(()=>[...e[47]||(e[47]=[n("加入明细",-1)])]),_:1})])):y("",!0)]),_:1})]),_:1}),l(pe),l(K,{data:U.value,size:"small",height:"260"},{default:u(()=>[l(r,{label:"#",type:"index",width:"50"}),l(r,{label:"商品",prop:"product_name","min-width":"160"}),l(r,{label:"尺码",prop:"size",width:"100"}),l(r,{label:"数量",prop:"quantity",width:"100",align:"center"}),l(r,{label:"单价(元)",width:"120",align:"right"},{default:u(({row:t})=>[n(g(Number(t.unit_cost||0).toFixed(2)),1)]),_:1}),l(r,{label:"操作",width:"100"},{default:u(({$index:t})=>[l(v,{size:"small",type:"danger",text:"",onClick:p=>he(t)},{default:u(()=>[...e[48]||(e[48]=[n("移除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}});typeof ce=="function"&&ce(sl);export{sl as default};
