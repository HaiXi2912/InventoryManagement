
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as ol,r as p,B as nl,C as sl,x as il,c as x,f as l,w as o,E as c,i as f,o as h,a as _,L as ul,M as oe,N as ne,h as m,_ as dl,G as me,O as rl,F as D,t as M,g as cl,D as ml,P as se,n as pl,p as fl,q as we}from"./index-BOHDOdY5.js";import{P as Q,a as C}from"./productExt-DU4KiciP.js";const vl={class:"product-management"},gl={class:"search-form"},_l={class:"card-header"},yl={class:"card-title"},bl={class:"price"},kl=["onMouseenter"],hl=["title"],wl={key:2,class:"text-muted"},Vl={class:"pagination-wrapper"},Sl={class:"media-form"},Cl=["src"],Ul={key:1},zl={class:"sku-section"},xl={style:{display:"flex","align-items":"center",gap:"12px"}},Ml={style:{display:"flex","align-items":"center",gap:"10px","flex-wrap":"wrap"}},Tl={class:"sku-meta-select"},$l={class:"flex items-center gap-2 mb-2"},Ll={class:"table-scroll"},Nl={class:"mt-2"},El={class:"table-scroll"},Pl={class:"dialog-footer"},Ve=ol({__name:"products",setup(Bl){const B=p(!1),T=p({keyword:"",category:""}),j=p([]),ie=p(0),G=p(10),$=p(1),L=p(!1),ue=p("添加商品"),W=p("base"),i=p({id:"",name:"",category:"",price:0,stock:0,minStock:0,status:"active",createTime:"",updateTime:""}),de=p(),Se={name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],category:[{required:!0,message:"请选择商品分类",trigger:"change"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{type:"number",min:.01,message:"价格必须大于0",trigger:"blur"}],minStock:[{required:!0,message:"请输入最低库存",trigger:"blur"},{type:"number",min:0,message:"最低库存不能为负数",trigger:"blur"}]},pe=["女装","男装","童装","内衣家居","运动户外","鞋靴","配饰","工装制服","大码/孕产","居家服/睡衣","其他"],U=p({}),fe=async t=>{if(!t)return;const e=U.value[t];if(!(e&&(e.loading||e.list&&e.list.length))){U.value[t]={loading:!0,list:(e==null?void 0:e.list)||[]};try{const n=(await C.listSkus(t)).data||[];U.value[t].list=n.map(y=>({id:y.id,size:y.size,stock:Number(y.stock||0)}))}catch(s){U.value[t].list=[]}finally{U.value[t].loading=!1}}},Ce=async()=>{const t=(j.value||[]).map(v=>v.id).filter(Boolean);if(!t.length)return;const e=4;let s=0;const n=async()=>{if(s>=t.length)return;const v=t[s++];try{await fe(v)}catch(b){}return n()},y=Array(Math.min(e,t.length)).fill(0).map(()=>n());await Promise.allSettled(y)},N=async()=>{var t,e,s,n,y;B.value=!0;try{const v={page:$.value,limit:G.value,category:T.value.category||void 0},b=await Q.getProductList(v);if(b.success!==!0)throw new Error(b.message||"获取商品列表失败");const d=(e=(t=b.data)==null?void 0:t.products)!=null?e:[];j.value=d.map(g=>{var H,r,q,ee,E,le,P,w,te;return{id:String(g.id),name:g.name,category:g.category||"",price:Number((q=(r=(H=g.retail_price)!=null?H:g.wholesale_price)!=null?r:g.purchase_price)!=null?q:0),stock:Number((ee=g.sku_stock_sum)!=null?ee:0),minStock:Number((E=g.min_stock)!=null?E:0),status:g.status==="active"?"active":"inactive",createTime:String((P=(le=g.createdAt)!=null?le:g.created_at)!=null?P:""),updateTime:String((te=(w=g.updatedAt)!=null?w:g.updated_at)!=null?te:"")}}),ie.value=Number((y=(n=(s=b.data)==null?void 0:s.pagination)==null?void 0:n.total_count)!=null?y:0),setTimeout(()=>{Ce()},0)}catch(v){c.error((v==null?void 0:v.message)||"获取商品列表失败"),j.value=[],ie.value=0}finally{B.value=!1}},ve=()=>{$.value=1,N()},Ue=()=>{T.value={keyword:"",category:""},$.value=1,N()},ze=()=>{ue.value="添加商品",i.value={id:"",name:"",category:"",price:0,stock:0,minStock:0,status:"active",createTime:"",updateTime:""},W.value="base",L.value=!0},xe=t=>{ue.value="编辑商品",i.value={...t},W.value="skus",L.value=!0},Me=async t=>{try{await se.confirm('确定要下架商品 "'.concat(t.name,'" 吗？该操作会将商品标记为已下架（软删除），在列表中不再展示。'),"确认下架",{confirmButtonText:"下架",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),await Q.deleteProduct(t.id),c.success("已下架"),N()}catch(e){}},re=p(null);function Te(){const t=Number(re.value||0);t<0||k.value.forEach(e=>{e.stock=t})}function $e(){k.value.forEach(t=>{t.stock=0})}function Le(t){t>0&&(k.value[t].stock=Number(k.value[t-1].stock||0))}async function Ne(){if(!i.value.id){c.warning("请先保存商品基础信息");return}if(!k.value.length){c.info("没有待创建的SKU");return}for(const t of k.value){if(!t.size){c.warning("存在未填写尺码的行");return}if(!t.barcode){c.warning("尺码 ".concat(t.size," 未填写条码"));return}if(!/^\d{1,32}$/.test(String(t.barcode))&&String(t.barcode).length<3){c.warning("条码格式不规范：".concat(t.barcode));return}const e=Number(t.stock||0);if(!Number.isInteger(e)||e<0){c.warning("尺码 ".concat(t.size," 的数量需为非负整数"));return}}try{R.value=!0;const t=k.value.map(e=>({size:e.size,barcode:String(e.barcode),tag_price:Number(J.value.tag_price||0),cost_price:Number(J.value.cost_price||0),stock:Number(e.stock||0),sort:Number(e.sort||0),status:e.status||"active"}));await C.batchCreateSkus(i.value.id,t),c.success("SKU创建成功"),k.value=[],await be(i.value.id)}catch(t){c.error((t==null?void 0:t.message)||"创建失败")}finally{R.value=!1}}const Ee=async()=>{de.value&&await de.value.validate(async t=>{var e,s,n;if(t)try{B.value=!0;const y={name:i.value.name,category:i.value.category,retail_price:i.value.price,min_stock:i.value.minStock,status:i.value.status};if(i.value.id)await Q.updateProduct(i.value.id,y),c.success("更新成功");else{const v=await Q.createProduct(y);if(v!=null&&v.success){const b=((s=(e=v.data)==null?void 0:e.product)==null?void 0:s.id)||((n=v.data)==null?void 0:n.id);b&&(i.value.id=String(b),c.success("创建成功"),setTimeout(()=>{var g;const d=document.querySelector(".product-edit-dialog .el-tabs__item:last-child");(g=d==null?void 0:d.click)==null||g.call(d)},50))}else throw new Error((v==null?void 0:v.message)||"创建失败")}L.value=!0,await N()}catch(y){c.error((y==null?void 0:y.message)||"保存失败")}finally{B.value=!1}})},Pe=t=>{G.value=t,$.value=1,N()},Be=t=>{$.value=t,N()},Ke=t=>t.stock===0?"danger":t.stock<=t.minStock?"warning":"success",ge=p(!1),X=p([]);async function Re(){var t;if(!ge.value)try{const e=await Q.getClothingMeta();e.success&&(X.value=((t=e.data)==null?void 0:t.sizes)||[],ge.value=!0)}catch(e){}}const O=p(!1),V=p({rich_html:"",mobile_html:"",seo_title:"",seo_keywords:"",seo_desc:""});async function Fe(t){O.value=!0;try{const e=await C.getContent(t);e.success&&(V.value={...e.data||{}})}finally{O.value=!1}}async function Ae(){if(i.value.id)try{O.value=!0,await C.saveContent(i.value.id,V.value),c.success("内容已保存")}catch(t){c.error((t==null?void 0:t.message)||"保存失败")}finally{O.value=!1}}const K=p(!1),I=p([]),z=p({url:"",type:"image",thumb_url:"",sort:0,is_main:!1}),He=nl(()=>{try{if(typeof localStorage<"u"){const t=localStorage.getItem("token")||"";return t?{Authorization:"Bearer ".concat(t)}:{}}}catch(t){}return{}});async function _e(t){K.value=!0;try{const e=await C.listMedia(t);e.success&&(I.value=e.data||[])}finally{K.value=!1}}async function qe(){if(i.value.id){if(!z.value.url){c.warning("请输入URL");return}try{K.value=!0,await C.createMedia(i.value.id,z.value),c.success("添加成功"),z.value={url:"",type:"image",thumb_url:"",sort:0,is_main:!1},await _e(i.value.id)}catch(t){c.error((t==null?void 0:t.message)||"添加失败")}finally{K.value=!1}}}async function ye(t,e){try{await C.updateMedia(t.id,e),e.is_main&&I.value.forEach(s=>{s.is_main=s.id===t.id}),Object.assign(t,e)}catch(s){c.error((s==null?void 0:s.message)||"更新失败")}}async function De(t){await se.confirm("确定删除该媒体资源?","提示",{type:"warning"}).catch(()=>{throw new Error("cancel")});try{await C.deleteMedia(t.id),c.success("已删除"),I.value=I.value.filter(e=>e.id!==t.id)}catch(e){e.message!=="cancel"&&c.error((e==null?void 0:e.message)||"删除失败")}}const R=p(!1),F=p([]),k=p([]),A=p([]),J=p({tag_price:0,cost_price:0});async function be(t){R.value=!0;try{const e=await C.listSkus(t);e.success&&(F.value=e.data||[])}finally{R.value=!1}}function Oe(){if(!A.value.length){c.warning("请选择尺码");return}const t=[];if(A.value.forEach(e=>{const s="".concat(i.value.id,"-").concat(e);!F.value.find(n=>n.size===e)&&!k.value.find(n=>n.size===e)&&t.push({size:e,color:"",barcode:s,tag_price:J.value.tag_price,cost_price:J.value.cost_price,stock:0,sort:0,status:"active"})}),!t.length){c.info("无新增组合");return}k.value=k.value.concat(t)}async function Ie(t,e,s){try{await C.updateSku(t.id,{[e]:s}),t[e]=s}catch(n){c.error((n==null?void 0:n.message)||"更新失败")}}async function Qe(t){const e=t.status==="active"?"disabled":"active";try{await C.updateSkuStatus(t.id,e),t.status=e}catch(s){c.error((s==null?void 0:s.message)||"状态更新失败")}}const Y=p("");function je(){const t=(Y.value||"").trim();if(t){if(t.length>20){c.warning("尺码长度不能超过20字符");return}X.value.includes(t)||X.value.push(t),A.value.includes(t)||A.value.push(t),Y.value=""}}async function Ge(t){try{if((t.stock||0)!==0||(t.locked_stock||0)!==0){await se.alert("该SKU库存或占用不为0，无法删除。请先盘点为0或释放占用。","无法删除",{type:"warning"});return}await se.confirm("确定删除尺码 ".concat(t.size," 的SKU吗？该操作不可恢复。"),"删除SKU",{type:"warning",confirmButtonText:"删除",cancelButtonText:"取消"}),await C.deleteSku(t.id),c.success("SKU已删除"),F.value=F.value.filter(e=>e.id!==t.id)}catch(e){(e==null?void 0:e.message)!=="cancel"&&c.error((e==null?void 0:e.message)||"删除失败")}}function We(t){c.info("Label printing WIP: ".concat(t.name))}const Z={skuIntro:"在这里按尺码生成SKU组合，并批量创建；已存在的SKU可修改条码、价格，或切换启用/停用。",sizeHelp:"勾选需要的尺码，点击“生成组合”后会出现在“待创建SKU”列表，点击“批量创建”后正式生效。",barcodeHelp:"条码可手动输入或使用扫码枪录入，需全局唯一。"};return sl(()=>L.value,async t=>{t&&i.value.id&&await Promise.all([Re(),Fe(i.value.id),_e(i.value.id),be(i.value.id)])}),il(()=>{N()}),(t,e)=>{const s=f("el-input"),n=f("el-form-item"),y=f("el-option"),v=f("el-select"),b=dl,d=f("el-button"),g=f("el-form"),H=f("el-card"),r=f("el-table-column"),q=f("el-tag"),ee=f("el-skeleton"),E=f("el-table"),le=f("el-pagination"),P=f("el-col"),w=f("el-input-number"),te=f("el-row"),ae=f("el-tab-pane"),Xe=f("el-upload"),Je=f("el-switch"),Ye=f("el-alert"),Ze=f("el-checkbox"),el=f("el-checkbox-group"),ll=f("el-text"),ke=f("el-divider"),he=f("el-tooltip"),tl=f("el-tabs"),al=f("el-dialog"),ce=rl("loading");return h(),x("div",vl,[l(H,{class:"search-card",shadow:"never"},{default:o(()=>[_("div",gl,[l(g,{model:T.value,inline:""},{default:o(()=>[l(n,{label:"关键字"},{default:o(()=>[l(s,{modelValue:T.value.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>T.value.keyword=a),placeholder:"商品名称",style:{width:"200px"},clearable:"",onKeyup:ul(ve,["enter"])},null,8,["modelValue"])]),_:1}),l(n,{label:"分类"},{default:o(()=>[l(v,{modelValue:T.value.category,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value.category=a),placeholder:"请选择分类",style:{width:"150px"},clearable:""},{default:o(()=>[(h(),x(oe,null,ne(pe,a=>l(y,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(d,{type:"primary",onClick:ve},{default:o(()=>[l(b,{name:"i-ep:search"}),e[26]||(e[26]=m(" 搜索 ",-1))]),_:1}),l(d,{onClick:Ue},{default:o(()=>[l(b,{name:"i-ep:refresh"}),e[27]||(e[27]=m(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),l(H,{class:"table-card",shadow:"never"},{header:o(()=>[_("div",_l,[_("span",yl,[l(b,{name:"i-ep:goods"}),e[28]||(e[28]=m(" 商品列表 ",-1))]),l(d,{type:"primary",onClick:ze},{default:o(()=>[l(b,{name:"i-ep:plus"}),e[29]||(e[29]=m(" 添加商品 ",-1))]),_:1})])]),default:o(()=>[me((h(),D(E,{data:j.value,border:"",stripe:"",style:{width:"100%"},"empty-text":"暂无数据"},{default:o(()=>[l(r,{prop:"id",label:"ID",width:"80"}),l(r,{prop:"name",label:"商品名称","min-width":"150"}),l(r,{prop:"category",label:"分类",width:"120"},{default:o(({row:a})=>[l(q,{type:"info"},{default:o(()=>[m(M(a.category),1)]),_:2},1024)]),_:1}),l(r,{prop:"price",label:"价格",width:"100"},{default:o(({row:a})=>[_("span",bl,"¥"+M(a.price.toFixed(2)),1)]),_:1}),l(r,{prop:"stock",label:"总库存(按尺码汇总)",width:"160"},{default:o(({row:a})=>[l(q,{type:Ke(a)},{default:o(()=>[m(M(a.stock),1)]),_:2},1032,["type"])]),_:1}),l(r,{label:"尺码库存","min-width":"260"},{default:o(({row:a})=>{var u;return[_("div",{class:"size-inline",onMouseenter:S=>fe(a.id)},[U.value[a.id]&&(U.value[a.id].list||[]).length?(h(!0),x(oe,{key:0},ne(U.value[a.id].list,S=>(h(),x("span",{key:S.id,class:pl(["size-chip",{danger:S.stock===0,warn:S.stock>0&&S.stock<=3}]),title:"".concat(S.size," 库存：").concat(S.stock)},M(S.size)+": "+M(S.stock),11,hl))),128)):(u=U.value[a.id])!=null&&u.loading?(h(),D(ee,{key:1,rows:1,animated:"",style:{width:"160px"}})):(h(),x("span",wl,"—"))],40,kl)]}),_:1}),l(r,{prop:"minStock",label:"最低库存",width:"100"}),l(r,{prop:"updateTime",label:"更新时间",width:"120"}),l(r,{label:"操作",width:"180",fixed:"right"},{default:o(({row:a})=>[l(d,{type:"primary",size:"small",onClick:u=>xe(a)},{default:o(()=>[l(b,{name:"i-ep:edit"}),e[30]||(e[30]=m(" 编辑 ",-1))]),_:1},8,["onClick"]),l(d,{type:"danger",size:"small",onClick:u=>Me(a)},{default:o(()=>[l(b,{name:"i-ep:delete"}),e[31]||(e[31]=m(" 下架 ",-1))]),_:1},8,["onClick"]),l(d,{size:"small",onClick:u=>We(a)},{default:o(()=>[...e[32]||(e[32]=[m("吊牌打印",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ce,B.value]]),_("div",Vl,[l(le,{"current-page":$.value,"onUpdate:currentPage":e[2]||(e[2]=a=>$.value=a),"page-size":G.value,"onUpdate:pageSize":e[3]||(e[3]=a=>G.value=a),"page-sizes":[10,20,50,100],total:ie.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Pe,onCurrentChange:Be},null,8,["current-page","page-size","total"])])]),_:1}),l(al,{modelValue:L.value,"onUpdate:modelValue":e[25]||(e[25]=a=>L.value=a),title:ue.value,width:"900px",class:"product-edit-dialog",top:"5vh","close-on-click-modal":!1},{footer:o(()=>[_("div",Pl,[l(d,{onClick:e[24]||(e[24]=a=>L.value=!1)},{default:o(()=>[...e[52]||(e[52]=[m("关闭",-1)])]),_:1}),l(d,{type:"primary",loading:B.value,onClick:Ee},{default:o(()=>[...e[53]||(e[53]=[m("保存基础信息",-1)])]),_:1},8,["loading"])])]),default:o(()=>[l(tl,{modelValue:W.value,"onUpdate:modelValue":e[23]||(e[23]=a=>W.value=a),type:"border-card"},{default:o(()=>[l(ae,{label:"基础信息",name:"base"},{default:o(()=>[l(g,{ref_key:"productFormRef",ref:de,model:i.value,rules:Se,"label-width":"100px",onSubmit:e[8]||(e[8]=cl(()=>{},["prevent"]))},{default:o(()=>[l(te,{gutter:20},{default:o(()=>[l(P,{span:24},{default:o(()=>[l(n,{label:"商品名称",prop:"name"},{default:o(()=>[l(s,{modelValue:i.value.name,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value.name=a),placeholder:"请输入商品名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),l(P,{span:12},{default:o(()=>[l(n,{label:"分类",prop:"category"},{default:o(()=>[l(v,{modelValue:i.value.category,"onUpdate:modelValue":e[5]||(e[5]=a=>i.value.category=a),placeholder:"请选择分类",style:{width:"100%"}},{default:o(()=>[(h(),x(oe,null,ne(pe,a=>l(y,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(P,{span:12},{default:o(()=>[l(n,{label:"价格",prop:"price"},{default:o(()=>[l(w,{modelValue:i.value.price,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value.price=a),min:.01,precision:2,step:.01,placeholder:"商品价格",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),l(P,{span:12},{default:o(()=>[l(n,{label:"最低库存",prop:"minStock"},{default:o(()=>[l(w,{modelValue:i.value.minStock,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value.minStock=a),min:0,placeholder:"最低库存",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(ae,{label:"富文本&SEO",name:"content"},{default:o(()=>[l(g,{"label-width":"100px",class:"mt-2"},{default:o(()=>[l(n,{label:"PC详情"},{default:o(()=>[l(s,{type:"textarea",rows:6,modelValue:V.value.rich_html,"onUpdate:modelValue":e[9]||(e[9]=a=>V.value.rich_html=a),placeholder:"支持HTML，后续接入富文本编辑器"},null,8,["modelValue"])]),_:1}),l(n,{label:"移动详情"},{default:o(()=>[l(s,{type:"textarea",rows:4,modelValue:V.value.mobile_html,"onUpdate:modelValue":e[10]||(e[10]=a=>V.value.mobile_html=a),placeholder:"移动端HTML"},null,8,["modelValue"])]),_:1}),l(n,{label:"SEO标题"},{default:o(()=>[l(s,{modelValue:V.value.seo_title,"onUpdate:modelValue":e[11]||(e[11]=a=>V.value.seo_title=a),maxlength:"150","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(n,{label:"SEO关键词"},{default:o(()=>[l(s,{modelValue:V.value.seo_keywords,"onUpdate:modelValue":e[12]||(e[12]=a=>V.value.seo_keywords=a),maxlength:"255","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(n,{label:"SEO描述"},{default:o(()=>[l(s,{type:"textarea",rows:3,modelValue:V.value.seo_desc,"onUpdate:modelValue":e[13]||(e[13]=a=>V.value.seo_desc=a),maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(d,{type:"primary",loading:O.value,onClick:Ae},{default:o(()=>[...e[33]||(e[33]=[m("保存内容",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),l(ae,{label:"媒体",name:"media"},{default:o(()=>[_("div",Sl,[l(g,{inline:"","label-width":"80px"},{default:o(()=>[l(n,{label:"URL"},{default:o(()=>[l(s,{modelValue:z.value.url,"onUpdate:modelValue":e[14]||(e[14]=a=>z.value.url=a),placeholder:"图片/视频URL",style:{width:"320px"}},null,8,["modelValue"])]),_:1}),l(n,{label:"缩略图"},{default:o(()=>[l(s,{modelValue:z.value.thumb_url,"onUpdate:modelValue":e[15]||(e[15]=a=>z.value.thumb_url=a),placeholder:"缩略图URL",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(v,{modelValue:z.value.type,"onUpdate:modelValue":e[16]||(e[16]=a=>z.value.type=a),style:{width:"100px"}},{default:o(()=>[l(y,{label:"图片",value:"image"}),l(y,{label:"视频",value:"video"})]),_:1},8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(d,{type:"primary",loading:K.value,onClick:qe},{default:o(()=>[...e[34]||(e[34]=[m("添加",-1)])]),_:1},8,["loading"])]),_:1}),l(n,{label:"本地上传"},{default:o(()=>[i.value.id?(h(),D(Xe,{key:0,action:"/api/products/".concat(i.value.id,"/media/upload"),name:"file",headers:He.value,"show-file-list":!1,accept:"image/*","on-success":t.onUploadSuccess,"on-error":t.onUploadError},{default:o(()=>[l(d,null,{default:o(()=>[...e[35]||(e[35]=[m("选择文件",-1)])]),_:1})]),_:1},8,["action","headers","on-success","on-error"])):ml("",!0)]),_:1})]),_:1}),me((h(),D(E,{data:I.value,size:"small",style:{width:"100%","margin-top":"10px"}},{default:o(()=>[l(r,{label:"预览",width:"100"},{default:o(({row:a})=>[a.type==="image"?(h(),x("img",{key:0,src:a.thumb_url||a.url,style:{width:"60px",height:"60px","object-fit":"cover"}},null,8,Cl)):(h(),x("span",Ul,"视频"))]),_:1}),l(r,{prop:"url",label:"URL","min-width":"200"}),l(r,{prop:"sort",label:"排序",width:"80"},{default:o(({row:a})=>[l(w,{modelValue:a.sort,"onUpdate:modelValue":u=>a.sort=u,size:"small",onChange:u=>ye(a,{sort:u}),min:0},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(r,{prop:"is_main",label:"主图",width:"70"},{default:o(({row:a})=>[l(Je,{modelValue:a.is_main,"onUpdate:modelValue":u=>a.is_main=u,onChange:u=>ye(a,{is_main:u})},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(r,{label:"操作",width:"120"},{default:o(({row:a})=>[l(d,{link:"",type:"danger",size:"small",onClick:u=>De(a)},{default:o(()=>[...e[36]||(e[36]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ce,K.value]])])]),_:1}),l(ae,{label:"SKU矩阵",name:"skus"},{default:o(()=>[_("div",zl,[l(Ye,{title:Z.skuIntro,type:"info","show-icon":"",closable:!1,class:"mb-2"},null,8,["title"]),l(H,{class:"mb-2",shadow:"never"},{header:o(()=>[_("div",xl,[e[37]||(e[37]=_("b",null,"尺码阈值/目标配置",-1)),l(b,{name:"i-ep:info-filled"})])]),default:o(()=>[_("div",Ml,[e[40]||(e[40]=_("span",null,"默认阈值",-1)),l(w,{modelValue:t.minThreshold,"onUpdate:modelValue":e[17]||(e[17]=a=>t.minThreshold=a),min:0,max:9999},null,8,["modelValue"]),e[41]||(e[41]=_("span",null,"默认目标",-1)),l(w,{modelValue:t.planTarget,"onUpdate:modelValue":e[18]||(e[18]=a=>t.planTarget=a),min:0,max:99999},null,8,["modelValue"]),l(d,{size:"small",onClick:t.applyReorderToAll},{default:o(()=>[...e[38]||(e[38]=[m("应用到全部尺码",-1)])]),_:1},8,["onClick"]),l(d,{size:"small",type:"primary",onClick:t.saveReorderConfig},{default:o(()=>[...e[39]||(e[39]=[m("保存阈值/目标",-1)])]),_:1},8,["onClick"]),e[42]||(e[42]=_("span",{style:{color:"#909399"}},"提示：当某尺码库存低于阈值时，系统会按目标自动生成工厂订单。",-1))])]),_:1}),_("div",Tl,[l(g,{inline:""},{default:o(()=>[l(n,{label:"尺码"},{default:o(()=>[l(el,{modelValue:A.value,"onUpdate:modelValue":e[19]||(e[19]=a=>A.value=a)},{default:o(()=>[(h(!0),x(oe,null,ne(X.value,a=>(h(),D(Ze,{key:a,label:a},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"自定义"},{default:o(()=>[l(s,{modelValue:Y.value,"onUpdate:modelValue":e[20]||(e[20]=a=>Y.value=a),size:"small",placeholder:"输入新尺码，如 2XL/165/均码",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(d,{size:"small",onClick:je},{default:o(()=>[...e[43]||(e[43]=[m("添加尺码",-1)])]),_:1})]),_:1}),l(n,null,{default:o(()=>[l(ll,{class:"help-text"},{default:o(()=>[m(M(Z.sizeHelp),1)]),_:1})]),_:1}),l(n,null,{default:o(()=>[l(d,{type:"primary",onClick:Oe},{default:o(()=>[...e[44]||(e[44]=[m("生成组合",-1)])]),_:1})]),_:1})]),_:1})]),l(ke,{"content-position":"left"},{default:o(()=>[m("待创建SKU ("+M(k.value.length)+")",1)]),_:1}),_("div",$l,[e[47]||(e[47]=_("span",{class:"text-muted"},"数量快捷：",-1)),l(w,{modelValue:re.value,"onUpdate:modelValue":e[21]||(e[21]=a=>re.value=a),min:0,step:1,size:"small",placeholder:"同填数量"},null,8,["modelValue"]),l(d,{size:"small",onClick:Te},{default:o(()=>[...e[45]||(e[45]=[m("同填",-1)])]),_:1}),l(d,{size:"small",onClick:$e},{default:o(()=>[...e[46]||(e[46]=[m("清零",-1)])]),_:1})]),_("div",Ll,[l(E,{data:k.value,size:"small",style:{width:"100%"}},{default:o(()=>[l(r,{prop:"size",label:"尺码",width:"80"}),l(r,{prop:"barcode",label:"条码","min-width":"200"},{default:o(({row:a})=>[l(he,{content:Z.barcodeHelp,placement:"top"},{default:o(()=>[l(s,{modelValue:a.barcode,"onUpdate:modelValue":u=>a.barcode=u,size:"small",placeholder:"可扫码枪输入"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["content"])]),_:1}),l(r,{prop:"stock",label:"初始数量",width:"110"},{default:o(({row:a,$index:u})=>[l(w,{modelValue:a.stock,"onUpdate:modelValue":S=>a.stock=S,min:0,step:1,size:"small",onChange:()=>Le(u)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(r,{label:"排序",width:"90"},{default:o(({row:a})=>[l(w,{modelValue:a.sort,"onUpdate:modelValue":u=>a.sort=u,min:0,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(r,{label:"操作",width:"120",fixed:"right"},{default:o(({row:a,$index:u})=>[l(d,{link:"",type:"danger",size:"small",onClick:S=>k.value.splice(u,1)},{default:o(()=>[...e[48]||(e[48]=[m("移除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_("div",Nl,[l(d,{type:"primary",size:"small",loading:R.value,onClick:Ne},{default:o(()=>[...e[49]||(e[49]=[m("批量创建",-1)])]),_:1},8,["loading"]),l(d,{size:"small",onClick:e[22]||(e[22]=a=>k.value=[])},{default:o(()=>[...e[50]||(e[50]=[m("清空",-1)])]),_:1})]),l(ke,{"content-position":"left"},{default:o(()=>[m("已存在SKU ("+M(F.value.length)+")",1)]),_:1}),_("div",El,[me((h(),D(E,{data:F.value,size:"small",style:{width:"100%"}},{default:o(()=>[l(r,{prop:"size",label:"尺码",width:"80"}),l(r,{prop:"barcode",label:"条码","min-width":"200"},{default:o(({row:a})=>[l(he,{content:Z.barcodeHelp,placement:"top"},{default:o(()=>[l(s,{modelValue:a.barcode,"onUpdate:modelValue":u=>a.barcode=u,size:"small",placeholder:"可扫码枪输入",onBlur:u=>Ie(a,"barcode",a.barcode)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:2},1032,["content"])]),_:1}),l(r,{prop:"stock",label:"库存",width:"90"}),l(r,{prop:"status",label:"状态",width:"100"},{default:o(({row:a})=>[l(q,{type:a.status==="active"?"success":"info",onClick:u=>Qe(a),style:{cursor:"pointer"}},{default:o(()=>[m(M(a.status==="active"?"启用":"停用"),1)]),_:2},1032,["type","onClick"])]),_:1}),l(r,{prop:"reorder_threshold",label:"最低库存(阈值)",width:"140"},{default:o(({row:a})=>[l(w,{modelValue:a.reorder_threshold,"onUpdate:modelValue":u=>a.reorder_threshold=u,modelModifiers:{number:!0},min:0,max:9999,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(r,{prop:"reorder_target",label:"自动进货目标",width:"140"},{default:o(({row:a})=>[l(w,{modelValue:a.reorder_target,"onUpdate:modelValue":u=>a.reorder_target=u,modelModifiers:{number:!0},min:0,max:99999,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(r,{label:"操作",width:"120",fixed:"right"},{default:o(({row:a})=>[l(d,{link:"",type:"danger",size:"small",onClick:u=>Ge(a)},{default:o(()=>[...e[51]||(e[51]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ce,R.value]])])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])])}}});typeof we=="function"&&we(Ve);const Fl=fl(Ve,[["__scopeId","data-v-d4926c7b"]]);export{Fl as default};
