import{d as V,r as d,c as y,a as k,e as a,w as s,f as o,b as h,k as i,h as x,E as p,i as C,_ as R}from"./index-DaL8kBdz.js";const I={class:"auth"},U=V({__name:"Register",setup(q){const c=C(),n=d(!1),g=d(),l=d({username:"",email:"",password:""}),_={username:[{required:!0,message:"请输入平台ID",trigger:"blur"},{pattern:/^[A-Za-z0-9][A-Za-z0-9_.-]{3,31}$/,message:"仅英数字/._-，长度4-32",trigger:["blur","change"]}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"至少6位",trigger:["blur","change"]}]};async function v(){try{await g.value?.validate()}catch{return}n.value=!0;try{const r={...l.value,username:l.value.username.trim()},{data:e}=await x.post("/api/auth/register",r);e?.success?(p.success("注册成功，请登录"),c.push("/login")):p.error(e?.message||"注册失败")}catch(r){const e=r?.response?.data?.message||r?.message||"注册失败";p.error(e)}finally{n.value=!1}}return(r,e)=>{const m=o("el-input"),u=o("el-form-item"),f=o("el-button"),b=o("el-form"),w=o("el-card");return k(),y("div",I,[a(w,{class:"auth-card",shadow:"never"},{header:s(()=>[...e[4]||(e[4]=[i("注册",-1)])]),default:s(()=>[a(b,{ref_key:"formRef",ref:g,model:l.value,rules:_,"label-width":"100px"},{default:s(()=>[a(u,{label:"平台ID",prop:"username"},{default:s(()=>[a(m,{modelValue:l.value.username,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.username=t),modelModifiers:{trim:!0},placeholder:"仅英数字/._-，4-32 位"},null,8,["modelValue"])]),_:1}),a(u,{label:"邮箱",prop:"email"},{default:s(()=>[a(m,{modelValue:l.value.email,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.email=t),modelModifiers:{trim:!0},placeholder:"name@example.com"},null,8,["modelValue"])]),_:1}),a(u,{label:"密码",prop:"password"},{default:s(()=>[a(m,{modelValue:l.value.password,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.password=t),type:"password","show-password":"",placeholder:"至少 6 位"},null,8,["modelValue"])]),_:1}),a(u,null,{default:s(()=>[a(f,{type:"primary",onClick:v,loading:n.value},{default:s(()=>[...e[5]||(e[5]=[i("注册",-1)])]),_:1},8,["loading"]),a(f,{link:"",onClick:e[3]||(e[3]=t=>r.$router.push("/login"))},{default:s(()=>[...e[6]||(e[6]=[i("去登录",-1)])]),_:1})]),_:1}),e[7]||(e[7]=h("div",{class:"tips"},"平台ID禁止中文，用于登录和识别；注册成功后将生成客户编码（如 CU000123）。",-1))]),_:1},8,["model"])]),_:1})])}}}),D=R(U,[["__scopeId","data-v-e1eb60d9"]]);export{D as default};
