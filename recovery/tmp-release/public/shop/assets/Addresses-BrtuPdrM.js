import{d as S,r as c,o as T,p as F,q as G,a as k,c as H,b as C,e as l,w as t,f as n,h as _,k as u,t as V,j as x,E as b,v as J,_ as K}from"./index-DaL8kBdz.js";const L={class:"addr"},O={class:"tools"},P=S({__name:"Addresses",setup(Q){const y=c(!1),w=c([]),i=c(!1),m=c(null),o=c({receiver_name:"",phone:"",province:"",city:"",district:"",detail:"",postcode:"",is_default:!1});async function f(){y.value=!0;try{const s=await _.get("/api/addresses");w.value=s.data?.data||[]}finally{y.value=!1}}function U(){m.value=null,o.value={receiver_name:"",phone:"",province:"",city:"",district:"",detail:"",postcode:"",is_default:!1},i.value=!0}function $(s){m.value=s.id,o.value={...s},i.value=!0}async function E(){m.value?(await _.put(`/api/addresses/${m.value}`,o.value)).data?.success&&(b.success("已保存"),i.value=!1,f()):(await _.post("/api/addresses",o.value)).data?.success&&(b.success("已新增"),i.value=!1,f())}async function B(s){await J.confirm("确定删除该地址？","提示",{type:"warning"}).catch(()=>{throw new Error("cancel")}),(await _.delete(`/api/addresses/${s.id}`)).data?.success&&(b.success("已删除"),f())}async function z(s){(await _.post(`/api/addresses/${s}/default`)).data?.success&&(b.success("已设为默认"),f())}return T(f),(s,e)=>{const v=n("el-button"),r=n("el-table-column"),D=n("el-tag"),M=n("el-link"),N=n("el-table"),p=n("el-input"),d=n("el-form-item"),A=n("el-switch"),I=n("el-form"),j=n("el-dialog"),q=G("loading");return F((k(),H("div",L,[e[17]||(e[17]=C("h2",null,"我的收货地址",-1)),C("div",O,[l(v,{type:"primary",onClick:U},{default:t(()=>[...e[10]||(e[10]=[u("新增地址",-1)])]),_:1})]),l(N,{data:w.value,border:"",size:"small"},{default:t(()=>[l(r,{label:"#",type:"index",width:"60"}),l(r,{label:"收货人",prop:"receiver_name",width:"120"}),l(r,{label:"电话",prop:"phone",width:"140"}),l(r,{label:"地址","min-width":"320"},{default:t(({row:a})=>[u(V(a.province)+V(a.city)+V(a.district)+" "+V(a.detail),1)]),_:1}),l(r,{label:"邮编",prop:"postcode",width:"100"}),l(r,{label:"默认",width:"100"},{default:t(({row:a})=>[a.is_default?(k(),x(D,{key:0,type:"success",size:"small"},{default:t(()=>[...e[11]||(e[11]=[u("默认",-1)])]),_:1})):(k(),x(M,{key:1,type:"primary",underline:!1,onClick:g=>z(a.id)},{default:t(()=>[...e[12]||(e[12]=[u("设为默认",-1)])]),_:1},8,["onClick"]))]),_:1}),l(r,{label:"操作",width:"180",fixed:"right"},{default:t(({row:a})=>[l(v,{size:"small",onClick:g=>$(a)},{default:t(()=>[...e[13]||(e[13]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(v,{size:"small",type:"danger",onClick:g=>B(a)},{default:t(()=>[...e[14]||(e[14]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),l(j,{modelValue:i.value,"onUpdate:modelValue":e[9]||(e[9]=a=>i.value=a),title:m.value?"编辑地址":"新增地址",width:"520px"},{footer:t(()=>[l(v,{onClick:e[8]||(e[8]=a=>i.value=!1)},{default:t(()=>[...e[15]||(e[15]=[u("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:E},{default:t(()=>[...e[16]||(e[16]=[u("保存",-1)])]),_:1})]),default:t(()=>[l(I,{model:o.value,"label-width":"90px"},{default:t(()=>[l(d,{label:"收货人"},{default:t(()=>[l(p,{modelValue:o.value.receiver_name,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.receiver_name=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"电话"},{default:t(()=>[l(p,{modelValue:o.value.phone,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.phone=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"省"},{default:t(()=>[l(p,{modelValue:o.value.province,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.province=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"市"},{default:t(()=>[l(p,{modelValue:o.value.city,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.city=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"区/县"},{default:t(()=>[l(p,{modelValue:o.value.district,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.district=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"详细地址"},{default:t(()=>[l(p,{modelValue:o.value.detail,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.detail=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"邮编"},{default:t(()=>[l(p,{modelValue:o.value.postcode,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.postcode=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"设为默认"},{default:t(()=>[l(A,{modelValue:o.value.is_default,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.is_default=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])),[[q,y.value]])}}}),W=K(P,[["__scopeId","data-v-0ec3a583"]]);export{W as default};
