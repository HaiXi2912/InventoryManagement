<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœè£…ç½‘åº—è¿›é”€å­˜ç³»ç»Ÿ - APIæ–‡æ¡£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .api-section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .api-section h2 {
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .api-item {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        
        .api-item.post {
            border-left-color: #007bff;
        }
        
        .api-item.put {
            border-left-color: #ffc107;
        }
        
        .api-item.delete {
            border-left-color: #dc3545;
        }
        
        .method {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.8em;
            margin-right: 10px;
        }
        
        .method.get {
            background: #28a745;
            color: white;
        }
        
        .method.post {
            background: #007bff;
            color: white;
        }
        
        .method.put {
            background: #ffc107;
            color: #333;
        }
        
        .method.delete {
            background: #dc3545;
            color: white;
        }
        
        .endpoint {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            font-weight: bold;
        }
        
        .description {
            margin: 10px 0;
            color: #666;
        }
        
        .params {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
        }
        
        .params h4 {
            margin-bottom: 10px;
            color: #495057;
        }
        
        .param-item {
            margin: 5px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .required {
            color: #dc3545;
            font-weight: bold;
        }
        
        .optional {
            color: #6c757d;
        }
        
        .test-section {
            background: #e7f3ff;
            border: 1px solid #007bff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:hover {
            background: #0056b3;
        }
        
        .test-result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .auth-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .auth-info h3 {
            color: #856404;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ API æ–‡æ¡£</h1>
            <p>æœè£…ç½‘åº—è¿›é”€å­˜ç³»ç»Ÿ RESTful API æ¥å£æ–‡æ¡£</p>
        </div>
        
        <div class="auth-info">
            <h3>ğŸ” è®¤è¯è¯´æ˜</h3>
            <p>é™¤äº†ç™»å½•å’Œæ³¨å†Œæ¥å£å¤–ï¼Œæ‰€æœ‰APIéƒ½éœ€è¦JWTè®¤è¯ã€‚åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ï¼š</p>
            <code>Authorization: Bearer {your_jwt_token}</code>
            <p style="margin-top: 10px;">é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·ï¼š<strong>admin / admin123</strong></p>
        </div>
        
        <!-- è®¤è¯API -->
        <div class="api-section">
            <h2>ğŸ”‘ ç”¨æˆ·è®¤è¯ API</h2>
            
            <div class="api-item post">
                <div>
                    <span class="method post">POST</span>
                    <span class="endpoint">/api/auth/login</span>
                </div>
                <div class="description">ç”¨æˆ·ç™»å½•ï¼Œè·å–JWT token</div>
                <div class="params">
                    <h4>è¯·æ±‚å‚æ•°ï¼š</h4>
                    <div class="param-item"><span class="required">username*</span> - ç”¨æˆ·å</div>
                    <div class="param-item"><span class="required">password*</span> - å¯†ç </div>
                </div>
            </div>
            
            <div class="api-item post">
                <div>
                    <span class="method post">POST</span>
                    <span class="endpoint">/api/auth/register</span>
                </div>
                <div class="description">ç”¨æˆ·æ³¨å†Œ</div>
                <div class="params">
                    <h4>è¯·æ±‚å‚æ•°ï¼š</h4>
                    <div class="param-item"><span class="required">username*</span> - ç”¨æˆ·å</div>
                    <div class="param-item"><span class="required">password*</span> - å¯†ç </div>
                    <div class="param-item"><span class="required">email*</span> - é‚®ç®±</div>
                    <div class="param-item"><span class="optional">real_name</span> - çœŸå®å§“å</div>
                    <div class="param-item"><span class="optional">phone</span> - æ‰‹æœºå·</div>
                </div>
            </div>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/auth/me</span>
                </div>
                <div class="description">è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆéœ€è¦è®¤è¯ï¼‰</div>
            </div>
            
            <div class="api-item post">
                <div>
                    <span class="method post">POST</span>
                    <span class="endpoint">/api/auth/logout</span>
                </div>
                <div class="description">é€€å‡ºç™»å½•ï¼ˆéœ€è¦è®¤è¯ï¼‰</div>
            </div>
        </div>
        
        <!-- å•†å“ç®¡ç†API -->
        <div class="api-section">
            <h2>ğŸ“¦ å•†å“ç®¡ç† API</h2>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/products</span>
                </div>
                <div class="description">è·å–å•†å“åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€ç­›é€‰ï¼‰</div>
                <div class="params">
                    <h4>æŸ¥è¯¢å‚æ•°ï¼š</h4>
                    <div class="param-item"><span class="optional">page</span> - é¡µç ï¼ˆé»˜è®¤1ï¼‰</div>
                    <div class="param-item"><span class="optional">limit</span> - æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤10ï¼‰</div>
                    <div class="param-item"><span class="optional">category</span> - å•†å“åˆ†ç±»</div>
                    <div class="param-item"><span class="optional">brand</span> - å“ç‰Œ</div>
                    <div class="param-item"><span class="optional">status</span> - çŠ¶æ€ï¼ˆé»˜è®¤activeï¼‰</div>
                </div>
            </div>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/products/:id</span>
                </div>
                <div class="description">è·å–å•ä¸ªå•†å“è¯¦æƒ…</div>
            </div>
            
            <div class="api-item post">
                <div>
                    <span class="method post">POST</span>
                    <span class="endpoint">/api/products</span>
                </div>
                <div class="description">åˆ›å»ºæ–°å•†å“</div>
                <div class="params">
                    <h4>è¯·æ±‚å‚æ•°ï¼š</h4>
                    <div class="param-item"><span class="required">name*</span> - å•†å“åç§°</div>
                    <div class="param-item"><span class="required">code*</span> - å•†å“ç¼–ç </div>
                    <div class="param-item"><span class="optional">category</span> - åˆ†ç±»</div>
                    <div class="param-item"><span class="optional">brand</span> - å“ç‰Œ</div>
                    <div class="param-item"><span class="optional">purchase_price</span> - è¿›è´§ä»·</div>
                    <div class="param-item"><span class="optional">retail_price</span> - é›¶å”®ä»·</div>
                    <div class="param-item">ç­‰å…¶ä»–å•†å“å±æ€§...</div>
                </div>
            </div>
            
            <div class="api-item put">
                <div>
                    <span class="method put">PUT</span>
                    <span class="endpoint">/api/products/:id</span>
                </div>
                <div class="description">æ›´æ–°å•†å“ä¿¡æ¯</div>
            </div>
            
            <div class="api-item delete">
                <div>
                    <span class="method delete">DELETE</span>
                    <span class="endpoint">/api/products/:id</span>
                </div>
                <div class="description">åˆ é™¤å•†å“ï¼ˆè½¯åˆ é™¤ï¼‰</div>
            </div>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/products/categories/list</span>
                </div>
                <div class="description">è·å–å•†å“åˆ†ç±»åˆ—è¡¨</div>
            </div>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/products/brands/list</span>
                </div>
                <div class="description">è·å–å“ç‰Œåˆ—è¡¨</div>
            </div>
        </div>
        
        <!-- åº“å­˜ç®¡ç†API -->
        <div class="api-section">
            <h2>ğŸ“Š åº“å­˜ç®¡ç† API</h2>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/inventory</span>
                </div>
                <div class="description">è·å–åº“å­˜åˆ—è¡¨</div>
                <div class="params">
                    <h4>æŸ¥è¯¢å‚æ•°ï¼š</h4>
                    <div class="param-item"><span class="optional">page</span> - é¡µç </div>
                    <div class="param-item"><span class="optional">limit</span> - æ¯é¡µæ•°é‡</div>
                    <div class="param-item"><span class="optional">warehouse_location</span> - ä»“åº“ä½ç½®</div>
                    <div class="param-item"><span class="optional">low_stock</span> - æ˜¯å¦åªæ˜¾ç¤ºä½åº“å­˜ï¼ˆtrue/falseï¼‰</div>
                </div>
            </div>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/inventory/product/:productId</span>
                </div>
                <div class="description">è·å–æŒ‡å®šå•†å“çš„åº“å­˜è¯¦æƒ…</div>
            </div>
            
            <div class="api-item post">
                <div>
                    <span class="method post">POST</span>
                    <span class="endpoint">/api/inventory/adjust</span>
                </div>
                <div class="description">åº“å­˜è°ƒæ•´ï¼ˆå…¥åº“/å‡ºåº“ï¼‰</div>
                <div class="params">
                    <h4>è¯·æ±‚å‚æ•°ï¼š</h4>
                    <div class="param-item"><span class="required">product_id*</span> - å•†å“ID</div>
                    <div class="param-item"><span class="required">adjustment_type*</span> - è°ƒæ•´ç±»å‹ï¼ˆin/outï¼‰</div>
                    <div class="param-item"><span class="required">quantity*</span> - æ•°é‡</div>
                    <div class="param-item"><span class="optional">reason</span> - è°ƒæ•´åŸå› </div>
                    <div class="param-item"><span class="optional">warehouse_location</span> - ä»“åº“ä½ç½®</div>
                </div>
            </div>
            
            <div class="api-item post">
                <div>
                    <span class="method post">POST</span>
                    <span class="endpoint">/api/inventory/stocktake</span>
                </div>
                <div class="description">åº“å­˜ç›˜ç‚¹</div>
                <div class="params">
                    <h4>è¯·æ±‚å‚æ•°ï¼š</h4>
                    <div class="param-item"><span class="required">product_id*</span> - å•†å“ID</div>
                    <div class="param-item"><span class="required">actual_stock*</span> - å®é™…åº“å­˜æ•°é‡</div>
                    <div class="param-item"><span class="optional">warehouse_location</span> - ä»“åº“ä½ç½®</div>
                    <div class="param-item"><span class="optional">remark</span> - å¤‡æ³¨</div>
                </div>
            </div>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/inventory/statistics</span>
                </div>
                <div class="description">è·å–åº“å­˜ç»Ÿè®¡ä¿¡æ¯</div>
            </div>
            
            <div class="api-item">
                <div>
                    <span class="method get">GET</span>
                    <span class="endpoint">/api/inventory/warehouses</span>
                </div>
                <div class="description">è·å–ä»“åº“åˆ—è¡¨</div>
            </div>
        </div>
        
        <!-- APIæµ‹è¯•å·¥å…· -->
        <div class="test-section">
            <h3>ğŸ§ª API æµ‹è¯•å·¥å…·</h3>
            <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•APIæ¥å£ï¼š</p>
            <button class="test-button" onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
            <button class="test-button" onclick="testProducts()">æµ‹è¯•å•†å“åˆ—è¡¨</button>
            <button class="test-button" onclick="testInventory()">æµ‹è¯•åº“å­˜åˆ—è¡¨</button>
            <button class="test-button" onclick="testStatistics()">æµ‹è¯•åº“å­˜ç»Ÿè®¡</button>
            
            <div id="testResult" class="test-result" style="display: none;"></div>
        </div>
    </div>

    <script>
        let currentToken = '';
        
        async function testLogin() {
            showResult('æ­£åœ¨æµ‹è¯•ç™»å½•API...');
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: 'admin',
                        password: 'admin123'
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentToken = data.data.token;
                    showResult('âœ… ç™»å½•æˆåŠŸï¼\n' + JSON.stringify(data, null, 2));
                } else {
                    showResult('âŒ ç™»å½•å¤±è´¥ï¼š' + data.message);
                }
            } catch (error) {
                showResult('âŒ è¯·æ±‚å¤±è´¥ï¼š' + error.message);
            }
        }
        
        async function testProducts() {
            if (!currentToken) {
                showResult('âš ï¸ è¯·å…ˆæµ‹è¯•ç™»å½•è·å–token');
                return;
            }
            
            showResult('æ­£åœ¨æµ‹è¯•å•†å“åˆ—è¡¨API...');
            try {
                const response = await fetch('/api/products?limit=5', {
                    headers: {
                        'Authorization': 'Bearer ' + currentToken
                    }
                });
                
                const data = await response.json();
                showResult('âœ… å•†å“åˆ—è¡¨è·å–æˆåŠŸï¼\n' + JSON.stringify(data, null, 2));
            } catch (error) {
                showResult('âŒ è¯·æ±‚å¤±è´¥ï¼š' + error.message);
            }
        }
        
        async function testInventory() {
            if (!currentToken) {
                showResult('âš ï¸ è¯·å…ˆæµ‹è¯•ç™»å½•è·å–token');
                return;
            }
            
            showResult('æ­£åœ¨æµ‹è¯•åº“å­˜åˆ—è¡¨API...');
            try {
                const response = await fetch('/api/inventory?limit=5', {
                    headers: {
                        'Authorization': 'Bearer ' + currentToken
                    }
                });
                
                const data = await response.json();
                showResult('âœ… åº“å­˜åˆ—è¡¨è·å–æˆåŠŸï¼\n' + JSON.stringify(data, null, 2));
            } catch (error) {
                showResult('âŒ è¯·æ±‚å¤±è´¥ï¼š' + error.message);
            }
        }
        
        async function testStatistics() {
            if (!currentToken) {
                showResult('âš ï¸ è¯·å…ˆæµ‹è¯•ç™»å½•è·å–token');
                return;
            }
            
            showResult('æ­£åœ¨æµ‹è¯•åº“å­˜ç»Ÿè®¡API...');
            try {
                const response = await fetch('/api/inventory/statistics', {
                    headers: {
                        'Authorization': 'Bearer ' + currentToken
                    }
                });
                
                const data = await response.json();
                showResult('âœ… åº“å­˜ç»Ÿè®¡è·å–æˆåŠŸï¼\n' + JSON.stringify(data, null, 2));
            } catch (error) {
                showResult('âŒ è¯·æ±‚å¤±è´¥ï¼š' + error.message);
            }
        }
        
        function showResult(text) {
            const resultDiv = document.getElementById('testResult');
            resultDiv.style.display = 'block';
            resultDiv.textContent = text;
        }
    </script>
</body>
</html>
